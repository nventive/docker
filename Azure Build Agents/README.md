# Windows 1809 with Visual Studio Enterprise Docker image
To generate a Docker image, you need to use [Docker with Windows containers](https://docs.docker.com/docker-for-windows/#switch-between-windows-and-linux-containers). Using that will require you to [enable Hyper-V](https://docs.microsoft.com/en-us/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v).
Once this is done, the [Docker daemon settings](https://docs.microsoft.com/en-us/virtualization/windowscontainers/manage-docker/configure-docker-daemon#configure-docker-with-a-configuration-file) need to be updated to increase the size of the containers. 
To do so, edit the configuration file and add the following section:
```json
  "storage-opts": [
    "size=120GB"
  ]
```
_Note: the size specified only controls the maximum size a container can have, not its exact size._

After applying this change and restarting the Docker service, the script located in this folder can be used.

## Installation script
The `Build-VSImage.ps1` script is pretty straightforward: it allows to build the image and tag it with the proper version of Visual Studio installed. The tage will have the form `{prefix}:vsXX.x.x` where prefix is set as a parameter.


### Parameters
- MajorVersion: the major version of Visual Studio to install; currently, only 15 and 16 are supported.
- PushImage: whether or not to push the image to a Docker registry
- DockerTagPrefix: the prefix for the tag to use on the generated image; for instance, the images generated by nventive use `nventive/build-agent` as a prefix.


### Results
As mentioned, the script generates an image with the latest version of Visual Studio available (according to the version given in parameter), tags and possibly push it to a registry.
A log file, called `Docker-{guid}.log` (where guid is a generated GUID), is also generated. It contains the log of the docker commands executed to generate the image.
